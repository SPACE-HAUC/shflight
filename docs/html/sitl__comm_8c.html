<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SPACE HAUC Flight Software: src/sitl_comm.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SPACE HAUC Flight Software
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">sitl_comm.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Software-In-The-Loop (SITL) serial communication codes.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="sitl__comm_8h_source.html">sitl_comm.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for sitl_comm.c:</div>
<div class="dyncontent">
<div class="center"><img src="sitl__comm_8c__incl.png" border="0" usemap="#src_2sitl__comm_8c" alt=""/></div>
<map name="src_2sitl__comm_8c" id="src_2sitl__comm_8c">
<area shape="rect" id="node2" href="sitl__comm_8h.html" title="Software&#45;In&#45;The&#45;Loop (SITL) serial communication headers and function prototypes. ..." alt="" coords="40,80,133,107"/>
<area shape="rect" id="node3" href="main_8h.html" title="Includes all headers necessary for the core flight software, including ACS, and defines ACS states (w..." alt="" coords="661,155,723,181"/>
<area shape="rect" id="node13" href="main__helper_8h.html" title="Defines vector macros and other helper functions for the flight software. " alt="" coords="329,453,431,480"/>
<area shape="rect" id="node20" href="shflight__consts_8h.html" title="Describes all constants defined by the preprocessor for the code. " alt="" coords="153,453,274,480"/>
<area shape="rect" id="node33" href="shflight__externs_8h.html" title="Extern declaration of the shflight global variables for all threads. " alt="" coords="101,304,227,331"/>
<area shape="rect" id="node19" href="bessel_8h.html" title="Bessel filter implementation for Attitude Control System. " alt="" coords="305,229,375,256"/>
<area shape="rect" id="node21" href="ncv7708_8h.html" title="Function prototypes and data structure for NCV77X8 SPI Driver (Linux) " alt="" coords="557,453,640,480"/>
<area shape="rect" id="node26" href="lsm9ds1_8h.html" title="Function prototypes and data structures for LSM9DS1 Magnetometer I2C driver. " alt="" coords="1083,453,1165,480"/>
<area shape="rect" id="node29" href="tsl2561_8h.html" title="TSL2561 I2C driver function and struct declarations. " alt="" coords="715,453,789,480"/>
<area shape="rect" id="node30" href="ads1115_8h.html" title="ADS1115 I2C Driver function prototypes and data structures. " alt="" coords="813,453,896,480"/>
<area shape="rect" id="node31" href="tca9458a_8h.html" title="Function prototypes and struct declarations for TCA9458A I2C driver. " alt="" coords="971,453,1058,480"/>
<area shape="rect" id="node32" href="acs_8h.html" title="Header file including headers and function prototypes of the Attitude Control System. " alt="" coords="226,229,281,256"/>
<area shape="rect" id="node34" href="datavis_8h.html" title="DataVis thread to visualize ACS data over TCP (uses client.py) " alt="" coords="352,379,427,405"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:addb98ee9cb8c68e817f90c122c0d739f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sitl__comm_8c.html#addb98ee9cb8c68e817f90c122c0d739f">set_interface_attribs</a> (int fd, int speed, int parity)</td></tr>
<tr class="memdesc:addb98ee9cb8c68e817f90c122c0d739f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set speed and parity attributes for the serial device.  <a href="#addb98ee9cb8c68e817f90c122c0d739f">More...</a><br /></td></tr>
<tr class="separator:addb98ee9cb8c68e817f90c122c0d739f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad300b122008561e90e3f13a60a0588fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sitl__comm_8c.html#ad300b122008561e90e3f13a60a0588fb">set_blocking</a> (int fd, int should_block)</td></tr>
<tr class="memdesc:ad300b122008561e90e3f13a60a0588fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the serial device as blocking or non-blocking.  <a href="#ad300b122008561e90e3f13a60a0588fb">More...</a><br /></td></tr>
<tr class="separator:ad300b122008561e90e3f13a60a0588fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23dab2add57439d712517009dfb6fc2f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sitl__comm_8c.html#a23dab2add57439d712517009dfb6fc2f">setup_serial</a> (void)</td></tr>
<tr class="memdesc:a23dab2add57439d712517009dfb6fc2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the up serial device Opens the serial device /dev/ttyS0 (for RPi only)  <a href="#a23dab2add57439d712517009dfb6fc2f">More...</a><br /></td></tr>
<tr class="separator:a23dab2add57439d712517009dfb6fc2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2a82a50442c2031b7bc2fe2bdac3566"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sitl__comm_8c.html#af2a82a50442c2031b7bc2fe2bdac3566">sitl_comm</a> (void *id)</td></tr>
<tr class="memdesc:af2a82a50442c2031b7bc2fe2bdac3566"><td class="mdescLeft">&#160;</td><td class="mdescRight">Serial communication thread.  <a href="#af2a82a50442c2031b7bc2fe2bdac3566">More...</a><br /></td></tr>
<tr class="separator:af2a82a50442c2031b7bc2fe2bdac3566"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Software-In-The-Loop (SITL) serial communication codes. </p>
<dl class="section author"><dt>Author</dt><dd>Sunip K. Mukherjee (<a href="#" onclick="location.href='mai'+'lto:'+'sun'+'ip'+'kmu'+'kh'+'erj'+'ee'+'@gm'+'ai'+'l.c'+'om'; return false;">sunip<span style="display: none;">.nosp@m.</span>kmuk<span style="display: none;">.nosp@m.</span>herje<span style="display: none;">.nosp@m.</span>e@gm<span style="display: none;">.nosp@m.</span>ail.c<span style="display: none;">.nosp@m.</span>om</a>) </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2020-03-19</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2020 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ad300b122008561e90e3f13a60a0588fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad300b122008561e90e3f13a60a0588fb">&#9670;&nbsp;</a></span>set_blocking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_blocking </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>should_block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the serial device as blocking or non-blocking. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>Serial device file descriptor </td></tr>
    <tr><td class="paramname">should_block</td><td>0 for non-blocking, 1 for blocking mode operation </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="addb98ee9cb8c68e817f90c122c0d739f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addb98ee9cb8c68e817f90c122c0d739f">&#9670;&nbsp;</a></span>set_interface_attribs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int set_interface_attribs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>speed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>parity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set speed and parity attributes for the serial device. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>Serial device file descriptor </td></tr>
    <tr><td class="paramname">speed</td><td>Baud rate, is a constant of the form B#### defined in termios.h </td></tr>
    <tr><td class="paramname">parity</td><td>Odd or even parity for the serial device (1, 0) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on error </dd></dl>

</div>
</div>
<a id="a23dab2add57439d712517009dfb6fc2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23dab2add57439d712517009dfb6fc2f">&#9670;&nbsp;</a></span>setup_serial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int setup_serial </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the up serial device Opens the serial device /dev/ttyS0 (for RPi only) </p>
<dl class="section return"><dt>Returns</dt><dd>file descriptor to the serial device </dd></dl>

</div>
</div>
<a id="af2a82a50442c2031b7bc2fe2bdac3566"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2a82a50442c2031b7bc2fe2bdac3566">&#9670;&nbsp;</a></span>sitl_comm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* sitl_comm </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Serial communication thread. </p>
<p>Communicates with the environment simulator over serial port. The serial communication happens at 230400 bps, and this thread is intended to loop at 200 Hz. The thread reads the packet over serial (packet format: [0xa0 x 10] [uint8 x 28] [0xb0 x 2]). The thread synchronizes to the 0xa0 in the beginning and checks for the 0xb0 at the end at each iteration. The data is read into global variables, and the magnetorquer command is read out. All read-writes are atomic.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>Pointer to an int that specifies thread ID </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NULL </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
